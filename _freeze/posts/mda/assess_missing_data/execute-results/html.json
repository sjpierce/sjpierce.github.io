{
  "hash": "cb9d1d7ec375e614634553069556235e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assessing Missing Data\"\ndescription: \"Examples of Assessing Missing Data.\"\ndate: \"2025-03-29\"\ndate-modified: \"2025-03-29\"\ndraft: false\ncategories:\n  - Quarto Tips\n  - Missing Data\n  - R\nformat: \n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    number-depth: 3\n    code-fold: true\n    code-tools: true\n    code-line-numbers: false\n    embed-resources: true \n    anchor-sections: true\n    link-external-icon: true\nexecute:\n  eval: true\n  echo: fenced\n  output: true\n  warning: true\n  error: true\n  include: true\n---\n\n# Purpose\nExamining the amount, nature, and patterns of missing data is crucial to \nproperly handling missing data \n[@McKnight-RN1296; @van_Buuren-RN3962; @White-RN3603]. There are no hard and\nfast rules about how much missing data constitutes a serious problem, but more\nmissing data usually means there is a greater risk of getting biased results if\nyour analysis relies on listwise deletion to handle missing data. One has to\nmake judgments about whether the amount and nature of the missing data issues in\nyour study warrant the effort required to implement sophisticated solutions such\nas multiple imputation (MI) or full information maximum likelihood (FIML)\nestimation. It is best to make such judgments after a thorough assessment of the\nmissingness. In short, you should diagnose the missing data situation before you \ndecide whether and how to treat the problem.\n\nThis post discusses a few simple things one should do along the way and provides\nR code that I might use in a Quarto script to do them, along with commentary on \nthe results obtained for an example data set. \n\nIn larger or more complex data sets this sort of assessment can be lengthy,\nso this post is by no means comprehensive. It's just demonstrating some \nessential summaries that you should examine. For more extensive guidance on \nassessing missing data issues, see books by @McKnight-RN1296, @Enders-RN8673, \nand @Graham-RN2677.\n\n:::{.callout-tip}\nAll the example code operates on a data frame. Naturally, changing the data \nset fed into the code will change the results. Think carefully about which \ndata set makes the most sense to use. You may need to subset a large data file \nby selecting the cases and variables relevant to your planned analyses before \napplying these techniques. \n:::\n\n# R Packages for Examining Missing Data\nThere are several R packages designed for dealing with missing data that have \nfunctions useful at the assessment stage. For example, `ggmice`, `mice`, \n`naniar`, and `VIM` are ones I happen to have installed. It's worth exploring \nthem to see what tools you like. Below, I have used `ggmice` and `mice` in my \nexamples.\n\n# Setup \nNext we load R packages that we need to get additional functions. \n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load-packages\n#| message: false\n\nlibrary(devtools)         # for session_info()\nlibrary(rmarkdown)        # for pandoc_version()\nlibrary(knitr)            # for kable()\noptions(kableExtra.latex.load_packages = FALSE)\nlibrary(kableExtra)       # for kable_styling(), add_header_above(), etc.\nlibrary(tidyverse)        # loads dplyr, ggplot2, lubridate, stringr all at once.\n                          # for %>%, filter(), mutate(), etc.\nlibrary(purrr)            # for map()\nlibrary(mice)             # for mice(), nic(), ncc(), and the boys data set. \nlibrary(modelsummary)     # for modelsummary()\nlibrary(ggmice)           # for plot_pattern(), plot_corr()\nlibrary(quarto)           # for quarto_version()\n```\n````\n:::\n\n\n# Example \nFor the example code below, we'll use the `boys` data [@Fredriks-RN8696], which\nis bundled with the the `mice` package [@van_Buuren-RN3208]. These data come\nfrom a developmental study about growth in Dutch boys. The variables include\nage, region, weight, height, body mass index, head circumference, and three\nmeasures of pubertal development. For more details about the dataset, use the\nfollowing command in the R console after loading the `mice` package: `?boys`.\n\n## Amount of Missing Data\nYou should always examine the dimensions of your data set in terms of numbers of \ncases (rows), variables (columns), and values (rows x columns). Extracting those \nvalues from a data set is easy using functions such as `nrow()` and `ncol()` as \nshown below. The number of values is obtained by multiplying the numbers of \ncases and variables. This sets the context for examining how much of the data is\nmissing. Additional functions from the `mice` package make it easy to extract \nnumbers of complete cases (`ncc()`) and incomplete cases `nic()`. Creative \ncombined use of the `sum()`, `colSums()`, and `is.na()` functions can get us \nsimilar counts of the number of complete and incomplete variables and of the \nnumber of complete (non-missing) and incomplete (missing) values. \n\nThe chunk below generates @tbl-dataset-info, which shows a convenient summary of \nall those counts. I plan to eventually add functions to my \n[`piercer`](https://github.com/sjpierce/piercer) package to automate generating \nthis sort of summary if I can't find an existing package that has one I like. \nThat would reduce the amount of code required to get the table. \n\n\n::: {#tbl-dataset-info .cell tbl-cap='Numbers of Complete and Incomplete Cases, Variables, and Values'}\n\n````{.cell-code}\n```{{r}}\n#| label: tbl-dataset-info\n#| tbl-cap: Numbers of Complete and Incomplete Cases, Variables, and Values\n\nN_cases  <- nrow(boys)                     # All cases\nN_ccases <- ncc(boys)                      # Complete cases\nN_icases <- nic(boys)                      # Incomplete cases  \nN_vars   <- ncol(boys)                     # All variables\nN_cvars  <- sum(colSums(is.na(boys)) == 0) # Complete variables\nN_ivars  <- sum(colSums(is.na(boys)) > 0)  # Incomplete variables\nN_vals   <- N_cases*N_vars                 # All values\nN_cvals  <- sum(!is.na(boys))              # Complete values (non-missing)\nN_ivals  <- sum(is.na(boys))               # Incomplete values (missing)\n\ntibble(Subset = c(\"Complete\", \"Incomplete\", \"All\"),\n       Cases = c(N_ccases, N_icases, N_cases),\n       Cases_P = 100*Cases/N_cases, \n       Variables = c(N_cvars, N_ivars, N_vars),\n       Variables_P = 100*Variables/N_vars,\n       Values = c(N_cvals, N_ivals, N_vals),\n       Values_P = 100*Values/N_vals) %>% \n  kable(., format = \"html\", digits = 1, \n        col.names = c(\"Subset\", rep(c(\"n\", \"%\"), times = 3))) %>%\n  kable_styling() %>% \n  add_header_above(., \n                   header = c(\" \", \"Cases\" = 2, \"Variables\" = 2, \"Values\" =  2))\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Cases</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Variables</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Values</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Subset </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> % </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> % </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> % </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Complete </td>\n   <td style=\"text-align:right;\"> 223 </td>\n   <td style=\"text-align:right;\"> 29.8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 11.1 </td>\n   <td style=\"text-align:right;\"> 5110 </td>\n   <td style=\"text-align:right;\"> 75.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Incomplete </td>\n   <td style=\"text-align:right;\"> 525 </td>\n   <td style=\"text-align:right;\"> 70.2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 88.9 </td>\n   <td style=\"text-align:right;\"> 1622 </td>\n   <td style=\"text-align:right;\"> 24.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All </td>\n   <td style=\"text-align:right;\"> 748 </td>\n   <td style=\"text-align:right;\"> 100.0 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 100.0 </td>\n   <td style=\"text-align:right;\"> 6732 </td>\n   <td style=\"text-align:right;\"> 100.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::{.callout-tip}\n* A value is just the datum for a specific case on a specific variable. It is \n  complete (observed) when it non-missing, and incomplete when it is missing. \n* A case is complete when all values on the row (across variables) are \n  complete; it becomes incomplete if any variable in that row has a missing \n  value. \n* Similarly, a variable is complete when all values in that column (across \n  cases) are complete but it becomes incomplete if any case in that column has \n  a missing value. \n  \n::: \n\nHere, we can see that there's a reasonably large sample size (748) but \nthere are only 9 variables. That yields a total of \n6732 values in the data set. \n\nWe see different percentages of completeness depending on whether we look at \ncases, variables, or values. This is a cross-sectional dataset, so we don't have \nto consider a time dimension but if we had a longitudinal study we might need \nto examine that as an additional dimension in the assessment. Similarly, this \nis not a multilevel study design but if it were, we might need to examine \nmissingness at each level of the design. \n\nThe percent of incomplete cases is staggeringly high \n(70.2%), as is the percent of incomplete \nvariables (88.9%). However, we can also see \nthat the percent of missing values in the full data frame is much lower \n(24.1%), though it may still be large \nenough to cause some concern. We need to know more before we make decisions. \n\n## Univariate Missingness\nWhile @tbl-dataset-info is a useful overview of the amount of missing data, we \nwant to do a more granular examination as well. For example, we now know that \nthere are 8 incomplete variables but the amount of missing data in \neach of those variables could be quite different. Maybe there's only one missing \nvalue among hundreds of cases for one variable, but hundreds of missing values \nfor another variable. That could be very important. \n\nSo, the next step is to examine univariate summaries of the amount of missing \ndata for each variable. The chunk below constructs @tbl-missing-by-var, which \nshows such a summary. \n\n\n::: {#tbl-missing-by-var .cell tbl-cap='Univariate Missingness in Boys Growth Data, (N = 748)'}\n\n````{.cell-code}\n```{{r}}\n#| label: tbl-missing-by-var\n#| tbl-cap: !expr paste0(\"Univariate Missingness in Boys Growth Data, (N = \", \n#|                       nrow(boys), \")\")\n\nboys %>% \n  list() %>%\n  map_dfr(~ tibble(Name = names(.x),\n                   N_Valid = colSums(!is.na(.x)),\n                   N_Missing = colSums(is.na(.x)),\n                   Pct_Missing = 100*(N_Missing/nrow(boys)))) %>%\n  rowid_to_column(., \"Position\") %>%\n  kable(., format = \"html\", digits = 1) %>%\n  kable_styling() \n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Position </th>\n   <th style=\"text-align:left;\"> Name </th>\n   <th style=\"text-align:right;\"> N_Valid </th>\n   <th style=\"text-align:right;\"> N_Missing </th>\n   <th style=\"text-align:right;\"> Pct_Missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 748 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> hgt </td>\n   <td style=\"text-align:right;\"> 728 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> wgt </td>\n   <td style=\"text-align:right;\"> 744 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> bmi </td>\n   <td style=\"text-align:right;\"> 727 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 2.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> hc </td>\n   <td style=\"text-align:right;\"> 702 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 6.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> gen </td>\n   <td style=\"text-align:right;\"> 245 </td>\n   <td style=\"text-align:right;\"> 503 </td>\n   <td style=\"text-align:right;\"> 67.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> phb </td>\n   <td style=\"text-align:right;\"> 245 </td>\n   <td style=\"text-align:right;\"> 503 </td>\n   <td style=\"text-align:right;\"> 67.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> tv </td>\n   <td style=\"text-align:right;\"> 226 </td>\n   <td style=\"text-align:right;\"> 522 </td>\n   <td style=\"text-align:right;\"> 69.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> reg </td>\n   <td style=\"text-align:right;\"> 745 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nInspection of @tbl-missing-by-var shows that `age` is the only variable with no \nmissing data. There is only a small amount of missing data for basic \nanthropometric measurements (`hgt`, `wgt`, `bmi`, `hc`) and region (`reg`), but \nthere is a large amount of missing data for the three measures of pubertal \ndevelopment (`gen`, `phb`, and `tv`). \n\nThe maximum percent missing observed in @tbl-missing-by-var for a single \nvariable can never be lower than the overall percent of incomplete cases from \n@tbl-dataset-info. However, the percent of incomplete cases can easily be higher \nthan any of the percentages for individual variables because missing data may \noccur in different variables on different cases. \n\nIf our planned analyses only required the anthropometric variables and region, \nthis data might be considered to have a fairly small amount of missing data. \nOne could remove the irrelevant variables from the data set and then re-create \n@tbl-dataset-info to get better estimates of how many incomplete cases would be \ndropped by listwise deletion. On the other hand, analyses requiring any of the \npubertal development measures would require solving an extremely large missing \ndata problem. \n\n## Multivariate Patterns of Missingness\nAfter examining the univariate missingness, we need to shift our focus to \nconsidering the patterns of missing data across variables. These multivariate \npatterns of missingness can be quite useful in better understanding that nature \nof the missingness issues in your data. @fig-patterns illustrates what I mean \nby missing data patterns. It is generated by the `ggmice` function \n`plot_pattern()`, which is a cleaner, better labeled alternative to the \ngraphical output from the `mice` function `md.pattern()`. \n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: fig-patterns\n#| fig-cap: \"Missingness Patterns for Dutch Boys Growth Study Data (748 boys, 9 \n#|           variables, 1 time point) [@Fredriks-RN8696]\"\n\nplot_pattern(boys, square = FALSE, rotate = FALSE)\n```\n````\n\n::: {.cell-output-display}\n![Missingness Patterns for Dutch Boys Growth Study Data (748 boys, 9 variables, 1 time point) [@Fredriks-RN8696]](assess_missing_data_files/figure-html/fig-patterns-1.png){#fig-patterns width=672}\n:::\n:::\n\n\nEach row in the graph represents a distinct pattern of observed versus missing\nvalues across the whole set of variables. The left side is annotated with the\nnumber of cases (i.e., boys) showing each pattern, the right side tells you how\nmany missing values there are on that row, and the bottom shows the total number\nof missing values for each variable. The variables are sorted from left to right \nin ascending order by number of missing values, so those on the right have the \nmost missing data. The annotation below the color coding legend shows the total \nnumber of missing values. Some of the information in this figure overlaps with \nthat in the tables above, but I find it useful to have the percentages in those \ntables along with the counts shown here. \n\nThe first row of @fig-patterns shows the 223 boys have complete data. \nThe rest of the plot shows that this data set has a lot of holes in it. For \nexample, we can see that the most common pattern is that 437 boys \n(58.4%) have missing data for all 3 pubertal \ndevelopment measures but observed data on all the other measures. We can also \nsee a number of patterns exhibited by only one boy each. The patterns with the \nhighest frequencies are probably the most useful ones to look at in this type of \nplot. Beware that data sets containing both large samples and large numbers of \nvariables can make plots like this hard to read. You may have to get creative \nabout using these tools with subsets of the data in such cases. \n\nAnother thing we can see here is that body mass index is *always* missing \nwhenever either height or weight is missing. That's construct missingness caused \nby item missingness because BMI is a measure derived from both the height and \nweight variables. Solving any missing data for height and weight appropriately \nwill let you solve missing BMI data as well. The `mice` package has features \ndesigned to handle preserving such deterministic relationships between variables \nduring imputation. \n\nInspect the patterns of missingness and try to make sense of them. That can\nreveal things like contiguous blocks of variables that are always missing\ntogether, which might be a result of things like participants skipping an entire\nsection of a survey. In a longitudinal study where the data file is laid out in\nwide, multivariate format (repeated measures over time are represented by sets\nof columns), wave non-response or dropout might show up the same way.\n\n## Predictors of Missingness\nIdentifying predictors of missingness is another step in assessing the nature of\nthe missing data. This stage of assessing missing data issues can become quite\nextensive if there are many variables. Simple bivariate analyses may suffice,\nbut you can use multivariate methods too. Just make sure you use models\nappropriate to the types of variables (nominal, ordinal, interval, ratio,\ncounts, etc.) being examined in any given analysis.\n\nObserved variables that are associated with whether another variable is missing\nreveal that your data are incompatible with the missing completely at random\n(MCAR) mechanism; instead the mechanism must either be missing at random (MAR) or \nmissing not at random (MNAR). \n\nSuppose in this boys growth study, we wanted to check whether the pubertal\ndevelopment variables were more likely to be missing for the youngest boys. That \nmight happen if data collection procedures specified assessing the pubertal \nvariables only for boys above some threshold age. We could create a set of\nbinary missingness indicators, one for each pubertal variable, coded 0 if the\npubertal variable was missing and 1 if it was observed. Then a logistic \nregression model could test whether age predicts the missingness indicator \nwell. @tbl-m1 shows that the missingness of the `tv` variable decreases with \neach additional year in age. This is actionable information about a potential \nsource of bias if missing data are not handled properly. \n\n\n::: {#tbl-m1 .cell tbl-cap='Logistic Regression Model Predicting Missingness of tv'}\n\n````{.cell-code}\n```{{r}}\n#| label: tbl-m1\n#| tbl-cap: Logistic Regression Model Predicting Missingness of tv\n#| warning: false\n\nm1 <- glm(is.na(tv) ~ age, family = binomial, data = boys)\noptions(modelsummary_factory_html = 'kableExtra')\nmodelsummary(m1, exponentiate = TRUE, \n             output = \"kableExtra\", align = \"lrrrrr\", escape = FALSE,\n             col.names = c(\"Term\", \"OR\", \"OR.LL\", \"OR.UL\", \"t\", \"p\"),\n             shape = term ~ model + statistic,\n             gof_omit = \"BIC|AIC\",\n             statistic = c(\"conf.int\", \"statistic\", \"p.value\"))\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"5\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \"> (1)</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Term </th>\n   <th style=\"text-align:right;\"> OR </th>\n   <th style=\"text-align:right;\"> OR.LL </th>\n   <th style=\"text-align:right;\"> OR.UL </th>\n   <th style=\"text-align:right;\"> t </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 16.934 </td>\n   <td style=\"text-align:right;\"> 11.230 </td>\n   <td style=\"text-align:right;\"> 26.545 </td>\n   <td style=\"text-align:right;\"> 12.921 </td>\n   <td style=\"text-align:right;\"> &lt;0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1.5px\"> age </td>\n   <td style=\"text-align:right;box-shadow: 0px 1.5px\"> 0.832 </td>\n   <td style=\"text-align:right;box-shadow: 0px 1.5px\"> 0.806 </td>\n   <td style=\"text-align:right;box-shadow: 0px 1.5px\"> 0.858 </td>\n   <td style=\"text-align:right;box-shadow: 0px 1.5px\"> −11.441 </td>\n   <td style=\"text-align:right;box-shadow: 0px 1.5px\"> &lt;0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Num.Obs. </td>\n   <td style=\"text-align:right;\"> 748 </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Log.Lik. </td>\n   <td style=\"text-align:right;\"> −Inf </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 130.902 </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> RMSE </td>\n   <td style=\"text-align:right;\"> 0.42 </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nAnother thought for this example data is that maybe the rate of missingness for\n`tv` varies across regions. We can check that with a contingency table and a \nchi-square test. It does not look like region is associated with missingess of \n`tv` in these data.\n\n\n::: {#tbl-reg-tv .cell tbl-cap='Contingency Table Region by Missingness of tv'}\n\n````{.cell-code}\n```{{r}}\n#| label: tbl-reg-tv\n#| tbl-cap: Contingency Table Region by Missingness of tv\n\nxtabs(~reg + is.na(tv), data = boys) %>% \n  kable(col.names = c(\"Region\", \"FALSE (n)\", \"TRUE (n)\")) %>% \n  kable_styling() %>% \n  add_header_above(., header = c(\" \", \"Missing tv\" = 2))\n\nxtabs(~reg + is.na(tv), data = boys) %>% chisq.test()\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Missing tv</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> FALSE (n) </th>\n   <th style=\"text-align:right;\"> TRUE (n) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> north </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> east </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> west </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 177 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> south </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 131 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> city </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 53 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  .\nX-squared = 6.1038, df = 4, p-value = 0.1915\n```\n\n\n:::\n:::\n\n\nPut some thought into what to examine and how to do it. You may not be able to \nexamine everything possible in a given data set, so be judicious about looking \nfor potential predictors of missingness. Use substantive knowledge to guide \nthose decisions if possible.\n\n# Extension to Multilevel Data\nSuppose you have a multilevel data structure, such as students (level 1) nested \nwithin schools (level 2), with variables measured at each level of analysis. \nIt would be prudent to assess missing data in each of the following data sets \nand think about what you learn from that before deciding how to handle the \nmissing data. \n\n## Level 2 Data Set\nStart by using a level 2 data set containing one row per school. Apply the \ntechniques discussed above to understand missingness for school-level measures.\nHow many schools have complete versus incomplete data? Missing school-level \nmeasures will affect all students from those schools after we merge the two \nlevels of data. \n\n## Level 1 Data Set\nThen, use a level 1 data set containing one row per student. This data set \nshould only contain student-level measures so you can get a pure look at how \nstudent-level missing data issues might affect your analysis. \n\n## Combined Dataset\nMerge the level 2 measures into the level 1 data set to get a combined data set \nwith one row per student that contains both student- and school-level measures.\nRepeat the missing data analysis on this combined data to learn how much the \nintersection of missingness across levels affects the number of complete cases.\nComparing the number of complete cases between the combined data set and the \nlevel 1 data set will reveal how much missing school-level measures will \nexacerbate any issues observed in the level 1 data. Some students may have \ncomplete data only when considering student-level measures, but have incomplete \ndata after merging in school-level measures. That will have consequences for \nyour analysis. \n\n# References\n::: {#refs}\n:::\n\n# Software Information\n\n- Software chain:\n  **qmd file > RStudio > Quarto > R > knitr > md file > Pandoc > html file**.\n- [Quarto 1.7.20](https://quarto.org/) runs `*.qmd` files through \n  [R](https://www.r-project.org/) and [knitr](https://yihui.org/knitr/) to \n  produce `*.md` markdown files.\n- [Pandoc 3.2](https://pandoc.org) converts markdown \n  files (`*.md`) to other formats, including LaTeX (`*.tex`) and HTML (`*.html`) \n  among others.\n\nThis document was generated using the following computational environment and \ndependencies: \n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: show-version\n\n# Get R and R package version numbers in use.\ndevtools::session_info()\n```\n````\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in system2(\"quarto\", \"-V\", stdout = TRUE, env = paste0(\"TMPDIR=\", :\nrunning command '\"quarto\"\nTMPDIR=C:/Users/pierces1/AppData/Local/Temp/RtmpOq0WAT/file569815d235d9 -V' had\nstatus 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.4.3 (2025-02-28 ucrt)\n os       Windows 11 x64 (build 22621)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  English_United States.utf8\n ctype    English_United States.utf8\n tz       America/New_York\n date     2025-03-29\n pandoc   3.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n quarto   NA @ C:\\\\PROGRA~1\\\\Quarto\\\\bin\\\\quarto.exe\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version  date (UTC) lib source\n backports      1.5.0    2024-05-23 [1] CRAN (R 4.4.0)\n bayestestR     0.15.2   2025-02-07 [1] CRAN (R 4.4.2)\n boot           1.3-31   2024-08-28 [1] CRAN (R 4.4.1)\n broom          1.0.8    2025-03-28 [1] CRAN (R 4.4.3)\n cachem         1.1.0    2024-05-16 [1] CRAN (R 4.4.0)\n checkmate      2.3.2    2024-07-29 [1] CRAN (R 4.4.1)\n cli            3.6.4    2025-02-13 [1] CRAN (R 4.4.2)\n coda           0.19-4.1 2024-01-31 [1] CRAN (R 4.4.0)\n codetools      0.2-20   2024-03-31 [1] CRAN (R 4.4.0)\n colorspace     2.1-1    2024-07-26 [1] CRAN (R 4.4.1)\n data.table     1.17.0   2025-02-22 [1] CRAN (R 4.4.2)\n datawizard     1.0.2    2025-03-24 [1] CRAN (R 4.4.3)\n devtools     * 2.4.5    2022-10-11 [1] CRAN (R 4.4.0)\n digest         0.6.37   2024-08-19 [1] CRAN (R 4.4.1)\n dplyr        * 1.1.4    2023-11-17 [1] CRAN (R 4.4.0)\n effectsize     1.0.0    2024-12-10 [1] CRAN (R 4.4.2)\n ellipsis       0.3.2    2021-04-29 [1] CRAN (R 4.4.0)\n emmeans        1.11.0   2025-03-20 [1] CRAN (R 4.4.3)\n estimability   1.5.1    2024-05-12 [1] CRAN (R 4.4.0)\n evaluate       1.0.3    2025-01-10 [1] CRAN (R 4.4.2)\n farver         2.1.2    2024-05-13 [1] CRAN (R 4.4.0)\n fastmap        1.2.0    2024-05-15 [1] CRAN (R 4.4.0)\n forcats      * 1.0.0    2023-01-29 [1] CRAN (R 4.4.0)\n foreach        1.5.2    2022-02-02 [1] CRAN (R 4.4.0)\n fs             1.6.5    2024-10-30 [1] CRAN (R 4.4.1)\n future         1.34.0   2024-07-29 [1] CRAN (R 4.4.1)\n future.apply   1.11.3   2024-10-27 [1] CRAN (R 4.4.1)\n generics       0.1.3    2022-07-05 [1] CRAN (R 4.4.0)\n ggmice       * 0.1.0    2023-08-07 [1] CRAN (R 4.4.0)\n ggplot2      * 3.5.1    2024-04-23 [1] CRAN (R 4.4.0)\n glmnet         4.1-8    2023-08-22 [1] CRAN (R 4.4.0)\n globals        0.16.3   2024-03-08 [1] CRAN (R 4.4.0)\n glue           1.8.0    2024-09-30 [1] CRAN (R 4.4.1)\n gtable         0.3.6    2024-10-25 [1] CRAN (R 4.4.1)\n hms            1.1.3    2023-03-21 [1] CRAN (R 4.4.0)\n htmltools      0.5.8.1  2024-04-04 [1] CRAN (R 4.4.0)\n htmlwidgets    1.6.4    2023-12-06 [1] CRAN (R 4.4.0)\n httpuv         1.6.15   2024-03-26 [1] CRAN (R 4.4.0)\n insight        1.1.0    2025-03-01 [1] CRAN (R 4.4.3)\n iterators      1.0.14   2022-02-05 [1] CRAN (R 4.4.0)\n jomo           2.7-6    2023-04-15 [1] CRAN (R 4.4.0)\n jsonlite       2.0.0    2025-03-27 [1] CRAN (R 4.4.3)\n kableExtra   * 1.4.0    2024-01-24 [1] CRAN (R 4.4.0)\n knitr        * 1.50     2025-03-16 [1] CRAN (R 4.4.3)\n later          1.4.1    2024-11-27 [1] CRAN (R 4.4.2)\n lattice        0.22-6   2024-03-20 [1] CRAN (R 4.4.0)\n lifecycle      1.0.4    2023-11-07 [1] CRAN (R 4.4.0)\n listenv        0.9.1    2024-01-29 [1] CRAN (R 4.4.0)\n lme4           1.1-37   2025-03-26 [1] CRAN (R 4.4.3)\n lmtest         0.9-40   2022-03-21 [1] CRAN (R 4.4.0)\n lubridate    * 1.9.4    2024-12-08 [1] CRAN (R 4.4.2)\n magrittr       2.0.3    2022-03-30 [1] CRAN (R 4.4.0)\n MASS           7.3-65   2025-02-28 [1] CRAN (R 4.4.3)\n Matrix         1.7-3    2025-03-11 [1] CRAN (R 4.4.3)\n memoise        2.0.1    2021-11-26 [1] CRAN (R 4.4.0)\n mice         * 3.17.0   2024-11-27 [1] CRAN (R 4.4.2)\n mime           0.13     2025-03-17 [1] CRAN (R 4.4.3)\n miniUI         0.1.1.1  2018-05-18 [1] CRAN (R 4.4.0)\n minqa          1.2.8    2024-08-17 [1] CRAN (R 4.4.1)\n mitml          0.4-5    2023-03-08 [1] CRAN (R 4.4.0)\n modelsummary * 2.3.0    2025-02-02 [1] CRAN (R 4.4.2)\n multcomp       1.4-28   2025-01-29 [1] CRAN (R 4.4.2)\n munsell        0.5.1    2024-04-01 [1] CRAN (R 4.4.0)\n mvtnorm        1.3-3    2025-01-10 [1] CRAN (R 4.4.2)\n nlme           3.1-167  2025-01-27 [1] CRAN (R 4.4.2)\n nloptr         2.2.1    2025-03-17 [1] CRAN (R 4.4.3)\n nnet           7.3-20   2025-01-01 [1] CRAN (R 4.4.2)\n pan            1.9      2023-08-21 [1] CRAN (R 4.4.0)\n parallelly     1.43.0   2025-03-24 [1] CRAN (R 4.4.3)\n parameters     0.24.2   2025-03-04 [1] CRAN (R 4.4.3)\n performance    0.13.0   2025-01-15 [1] CRAN (R 4.4.2)\n pillar         1.10.1   2025-01-07 [1] CRAN (R 4.4.2)\n pkgbuild       1.4.7    2025-03-24 [1] CRAN (R 4.4.3)\n pkgconfig      2.0.3    2019-09-22 [1] CRAN (R 4.4.0)\n pkgload        1.4.0    2024-06-28 [1] CRAN (R 4.4.1)\n processx       3.8.6    2025-02-21 [1] CRAN (R 4.4.2)\n profvis        0.4.0    2024-09-20 [1] CRAN (R 4.4.1)\n promises       1.3.2    2024-11-28 [1] CRAN (R 4.4.2)\n ps             1.9.0    2025-02-18 [1] CRAN (R 4.4.2)\n purrr        * 1.0.4    2025-02-05 [1] CRAN (R 4.4.2)\n quarto       * 1.4.4    2024-07-20 [1] CRAN (R 4.4.1)\n R6             2.6.1    2025-02-15 [1] CRAN (R 4.4.2)\n rbibutils      2.3      2024-10-04 [1] CRAN (R 4.4.1)\n Rcpp           1.0.14   2025-01-12 [1] CRAN (R 4.4.2)\n Rdpack         2.6.3    2025-03-16 [1] CRAN (R 4.4.3)\n readr        * 2.1.5    2024-01-10 [1] CRAN (R 4.4.0)\n reformulas     0.4.0    2024-11-03 [1] CRAN (R 4.4.1)\n remotes        2.5.0    2024-03-17 [1] CRAN (R 4.4.0)\n rlang          1.1.5    2025-01-17 [1] CRAN (R 4.4.2)\n rmarkdown    * 2.29     2024-11-04 [1] CRAN (R 4.4.2)\n rpart          4.1.24   2025-01-07 [1] CRAN (R 4.4.2)\n rstudioapi     0.17.1   2024-10-22 [1] CRAN (R 4.4.1)\n sandwich       3.1-1    2024-09-15 [1] CRAN (R 4.4.1)\n scales         1.3.0    2023-11-28 [1] CRAN (R 4.4.0)\n sessioninfo    1.2.3    2025-02-05 [1] CRAN (R 4.4.2)\n shape          1.4.6.1  2024-02-23 [1] CRAN (R 4.4.0)\n shiny          1.10.0   2024-12-14 [1] CRAN (R 4.4.2)\n stringi        1.8.7    2025-03-27 [1] CRAN (R 4.4.3)\n stringr      * 1.5.1    2023-11-14 [1] CRAN (R 4.4.0)\n survival       3.8-3    2024-12-17 [1] CRAN (R 4.4.2)\n svglite        2.1.3    2023-12-08 [1] CRAN (R 4.4.0)\n systemfonts    1.2.1    2025-01-20 [1] CRAN (R 4.4.2)\n tables         0.9.31   2024-08-29 [1] CRAN (R 4.4.1)\n TH.data        1.1-3    2025-01-17 [1] CRAN (R 4.4.2)\n tibble       * 3.2.1    2023-03-20 [1] CRAN (R 4.4.0)\n tidyr        * 1.3.1    2024-01-24 [1] CRAN (R 4.4.0)\n tidyselect     1.2.1    2024-03-11 [1] CRAN (R 4.4.0)\n tidyverse    * 2.0.0    2023-02-22 [1] CRAN (R 4.4.0)\n timechange     0.3.0    2024-01-18 [1] CRAN (R 4.4.0)\n tzdb           0.5.0    2025-03-15 [1] CRAN (R 4.4.3)\n urlchecker     1.0.1    2021-11-30 [1] CRAN (R 4.4.0)\n usethis      * 3.1.0    2024-11-26 [1] CRAN (R 4.4.2)\n vctrs          0.6.5    2023-12-01 [1] CRAN (R 4.4.0)\n viridisLite    0.4.2    2023-05-02 [1] CRAN (R 4.4.0)\n withr          3.0.2    2024-10-28 [1] CRAN (R 4.4.1)\n xfun           0.51     2025-02-19 [1] CRAN (R 4.4.2)\n xml2           1.3.8    2025-03-14 [1] CRAN (R 4.4.3)\n xtable         1.8-4    2019-04-21 [1] CRAN (R 4.4.0)\n yaml           2.3.10   2024-07-26 [1] CRAN (R 4.4.1)\n zoo            1.8-13   2025-02-22 [1] CRAN (R 4.4.2)\n\n [1] C:/Users/pierces1/AppData/Local/R/win-library/4.4\n [2] C:/Program Files/R/R-4.4.3/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [
      "assess_missing_data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}